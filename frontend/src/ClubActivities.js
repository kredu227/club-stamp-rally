import React, { useState, useEffect, useRef } from 'react';
import { useLocation } from 'react-router-dom';
import './ClubActivities.css';

const activities = [
  {
    "name": "mRNA",
    "location": "2-4",
    "description": "금속염 자라는 화학정원, 호르몬 표적기관 다트 맞히기, 45cm 골격 시간내 퍼즐조립, UV 스캔 손세균 청결배틀",
    "detail": "저희 M/RNA 동아리 부스에는 먼저 ‘화학 정원 실험 쇼 부스’가 있습니다. 화학 정원 실험 쇼 부스에서 참가자는 금속염 용액을 배치해 ‘결정 식물’이 자라는 과정을 직접 만들고 관찰합니다. 진행자가 삼투압과 결정 성장 원리를 간단한 설명으로 풀어주고, 눈에 보이는 변화로 화학 개념을 직관적으로 이해하게 합니다. 관찰 후에는 짧은 퀴즈로 화학 정원에 대한 지식을 확인합니다. 두 번째 부스 활동으로는 ’호르몬 표적기관 다트 놀이’가 있습니다. 호르몬 카드 뽑고 표적기관 보드에 다트 한 발!! 인슐린·에스트로겐 등 각 호르몬의 대표 표적기관을 맞히면 진행자가 호르몬에 대한 즉석 해설과 ‘왜 그 호르몬이 그 기관에 작용하는지’ 짧고 이해하기 쉽게 알려줍니다. 정확도와 순발력으로 점수 경쟁을 벌이되, 학습 요소를 콕 집어주는 부스입니다. 세 번째 부스로는 ‘인체 골격 맞추기 (45cm 모델 퍼즐)‘이 있습니다. 부서진 45cm 인체 골격을 제한 시간 안에 원상복구하는 리얼리티 미션! 뼈 위치와 명칭, 기능을 힌트로 제공합니다. 완성도(정렬·조립 정확도)와 소요 시간으로 채점해 승부를 가리며, 해부학적 이해가 관건입니다. 마지막 활동으로는‘UV 핸드 스캐닝 미션 (손 씻기 배틀)’이 있습니다. 세 명이 손을 깨끗이 씻고 무해한 형광표시제를 바른 뒤 UV램프로 스캔! 빛 아래 드러나는 형광 잔여물로 ‘어느 손이 가장 깨끗한지’ 시각적으로 판단합니다. 올바른 손 씻기 시연과 함께 위생 습관의 중요성을 체감하도록 구성되어 있고, 관찰 결과에 따라 보상도 지급. 안전·동의 절차를 거쳐 누구나 부담없이 체험 가능한 교육형 예능 미션입니다."
  },
  {
    "name": "가피",
    "location": "물리실",
    "description": "문과든 이과든 지금 너희에겐 가피가피료해",
    "detail": "다음 5가지의 활동을 모두 마친 학생에게 스탬프와 꽝없는 뽑기까지!!! 에바가리온 스페셜 굿즈까지 놓치지 마세요! / 찌릿찌릿 감전체험! 전기를 온몸으로 느껴보세요! 안전보장 / 각운동량 보존법칙을 이용하여 최고 회전수를 노리는 게임! / 평고 최고의 전력왕을 가려라! 인간 발전기 게임 / 빛의 반사를 이용해 레이저를 탈출시키고, 평고 1짱의 기록에 도전하세요! / 플라스틱 컵, 풍선을 이용하여 테무산 도라에몽이 되어 종이컵을 많이 떨어뜨리며 친구와 겨루어 보세요."
  },
  {
    "name": "개척",
    "location": "2-10",
    "description": "기업가 정신으로 사회문제를 해결하는 실천형 동아리 체험 부스",
    "detail": "저희 동아리는 세 가지 체험 부스를 통해 기업가정신과 사회문제 해결력을 기릅니다. 첫째, 트롤리 문제 게임 부스에서는 윤리적 딜레마 속에서 서로의 선택을 비교하며 공감과 의사소통 능력을 키웁니다. 둘째, 가짜뉴스 퀴즈 부스에서는 진짜와 가짜를 구분하며 비판적 사고와 미디어 리터러시를 높입니다. 셋째, 종이 한 장 챌린지 부스에서는 제한된 자원 속 창의적 구조 설계를 통해 문제 해결 능력을 체험합니다. 적극적인 참여자에게는 간식과 상품이 제공됩니다."
  },
  {
    "name": "국과수",
    "location": "영어실",
    "description": "과학 상식·체험 미션·롤러코스터까지 한 번에 즐기는 스릴만점 방탈출 부스!",
    "detail": "팀당 4~10명이 참여하는 이번 동아리 부스는 호러 테마의 방탈출 형식으로 운영되며, 기본 제한시간은 8분이다. 참가자들은 어두운 분위기의 방 안에서 다양한 장치를 탐색하며 문제를 해결해 탈출해야 한다. 방 내부에는 두 종류의 퀴즈가 존재하는데, 우선 방탈출의 핵심이 되는 ‘메인 퀴즈’는 과학 상식을 기반으로 구성되어 비밀번호를 찾거나 장치를 작동시키는 데 필요한 핵심 단서를 제공한다. 따라서 메인 퀴즈를 해결해야만 전체 방탈출 흐름이 진행된다. 동시에 방 안에는 동아리 스탬프를 얻기 위해 풀어야 하는 ‘스탬프 퀴즈’가 총 5개 배치되어 있다. 스탬프 퀴즈는 단순 지식 문제가 아니라 실제 동작과 탐구 원리를 적용해야 하는 체험형 미션으로 구성된다. 에어 로켓을 발사해 표적에 명중시키는 문제, 정해진 거리에서 농구공을 림에 넣는 문제, 범인의 DNA 염기서열을 정확히 맞추는 문제, 여러 용액의 산성·염기성을 판별하는 문제, 손 감각만으로 타이머를 5.00초에 최대한 근접하게 멈추는 문제 등 총 다섯 가지다. 이 스탬프 퀴즈는 각 문제를 해결할 때마다 제한시간이 1분씩 추가로 주어지므로, 기본 8분에서 최대 13분까지 시간이 늘어날 수 있다. 참가자들은 공포 분위기 속에서 메인 퀴즈와 스탬프 퀴즈를 전략적으로 선택해 해결하며 제한시간을 확보해야 한다. 팀이 최종적으로 방탈출에 성공하면 방의 마지막 구간에 설치된 롤러코스터 구조물을 통해 탈출하며 미션을 마무리한다. 만약 스탬프 퀴즈를 해결한 경우에는 자동으로 동아리 스탬프가 지급되지만, 스탬프 퀴즈를 풀지 못한 팀은 롤러코스터 주변에 배치된 QR 스티커 중 진짜 QR과 가짜 QR을 구분해 올바른 QR을 스캔해야만 스탬프를 획득할 수 있다. 이는 마지막까지 긴장감을 유지시키는 장치로, 참가자들에게 또 다른 재미를 제공한다. 전체적으로 이번 부스는 과학 상식 기반의 퍼즐과 다양한 체험형 스탬프 퀴즈, 그리고 공포 테마 연출이 결합된 형태로 설계되어 있어 흥미와 몰입감을 동시에 느낄 수 있는 활동이 되도록 기획되었다."
  },
  {
    "name": "그대의 말로",
    "location": "2-2",
    "description": "직접 만드는 IF결말, 지식+ 문인 스무고개",
    "detail": "IF 결말 부스에서는 문예부 부원들이 직접 창작한 작품의 결말을 자기 손으로 정할 수 있습니다. 문제 되지 않는 한 어떤 결말이든 상관 없습니다. 여러분의 창의력을 뽐내주세요! 문인 스무고개는 지금까지 여러분들 기억 속 알게 모르게 있었던 문인들을 최대 스무번 질문을 통해 맞추면 되는 부스입니다. 이건 아주 중요한 부스 인데... 스무번 안에 문인을 맞추신 분들께 스탬프를 찍어드리거든요. 그럼 많은 참여 부탁드립니다!"
  },
  {
    "name": "그루터기",
    "location": "도서관",
    "description": "::AI와 창의활동을 결합한 놀이·공예·퀴즈·사진·문장 만들기 체험 활동",
    "detail": "1. AI사서선생님 한테 책 가져가기 2. 슈링크지 키링 만들기 3. 책 관련 퀴즈 4. 릴레이 Ai이미지 만들기 5. 폐도서 공예"
  },
  {
    "name": "글로벌리더십",
    "location": "2-1",
    "description": "생리통 체험하며 미션수행하기, 식용곤충 시식, 사격을 통해 퀴즈 맞추기, 쓰레기 농구",
    "detail": "간단한 미션 3가지 이상 참여시 스탬프 획득 가능! 생리통 체험 미션 부스에서는 체험기를 착용한 채 이름 쓰기 등 간단한 미션에 도전할 수 있다. 곤충 시식 부스에서는 미션 결과에 따라 밀웜과 귀뚜라미, 과자 중 한 가지를 먹을 수 있다. 너프 건 퀴즈 부스에서는 사격을 통해 정답을 맞힐 수 있고, 쓰레기 농구 부스에서는 농구처럼 분리수거를 할 수 있다."
  },
  {
    "name": "나라사랑",
    "location": "2-5",
    "description": "군번줄 만들기(전사의 표식), 사격(탕탕특공대), 포토존(사전체험), 경쟁(최후의 1인)",
    "detail": "군번줄 만들기 (전사의 표식)은 이름,기수,학번으로 만들어 한 줄의 군번줄에 담긴 책임과 사명을 손끝으로 느껴보는 활동입니다. 사격(탕탕특공대)는 총은 너프건으로 사격을 할 수 있는 활동을 진행합니다. 포토존(사전체험)은 실제 군복과 위장크림(선택) 그리고 총과 함께 폴라로이드로 사진을 찍을 수 있는 활동을 합니다. 경쟁(최후의 1인)은 군인의 필수 요소인 운동을 윗몸일으키기, 팔굽혀펴기, 허벅지 싸움으로 순위 경쟁하는 활동을 진행합니다. 이중 2개를 택해 완전히 활동을 완수해야 스탬프가 나갑니다."
  },
  {
    "name": "내꿈찾아삼만리",
    "location": "1-4",
    "description": "돌려 돌려 돌림판 이건 나의 직업 타임",
    "detail": "개인전과 팀전이 있는데 팀전은 스피드 퀴즈이고 주제는 직업과 학과입니다. 2명이상씩 와주시면 됩니다.돌림판을 돌려서 나온 언어나 몸짓으로 직업과 학과를 스피드퀴즈로 하시면 되겠습니다.스피드퀴즈를 참가하시면 스템프와 간식을 받으실수 있습니다.그리고 제한시간 안에 가장 많이 맞춘 팀에게는 소소한 상품이 주어집니다. 개인전은 돌림판을 돌려 나온 직업에 맞는 미션을 깨시면 스템프와 간식을 받을실수있습니다. 하지만 미션이 호락호락하지 않을겁니다."
  },
  {
    "name": "농구부",
    "location": "2-7",
    "description": "미니 농구대에 슛을 넣는 미니게임 진행",
    "detail": "미니 농구대에 슛기회를 주고 성공 개수만큼 상품을 준다"
  },
  {
    "name": "대중문화탐구부",
    "location": "1-3",
    "description": "음악/게임/영화/애니메이션 4팀 체험부스",
    "detail": "각각 음악,게임,영화,애니와 관련된 4개 부스 체험입니다."
  },
  {
    "name": "독수공방",
    "location": "2-8",
    "description": "수학으로 즐기는 다양한 체험과 여러가지 상품들!",
    "detail": "독수공방의 부스는 한 줄 암산, 평택고 수학 챌린지, 소마 큐브, 확률 기반 놀이터 코너로 구성되어 있습니다! 한 줄 암산 코너에서는 사칙연산 문제를 빨리 풀면 상품을 얻을 수 있습니다! 평택고 수학 챌린지에서는 제한 시간 안에 수학 문제를 풀어야하며, 소마큐브 코너에서는 특이한 모양의 조각들을 맞춰 퍼즐을 완성하며 즐길 수 있습니다. 마지막 확률 기반 놀이터는 칩을 베팅해 상대의 칩을 뺏고 잃는 짜릿한 승부가 펼쳐지는 곳으로, 모은 칩이 많을수록 상품의 가치도 올라갑니다! 위 4개의 코너 중 3개 이상의 코너에 참여하시면 스탬프를 찍어드립니다!"
  },
  {
    "name": "또래상담",
    "location": "3-10",
    "description": "펑펑!! 힐링 부스 : 스트레스 해소를 위한 풍선 터트리기 및 원데이 클래스",
    "detail": "1. 탄소중립 미션을 완료한 뒤 풍선 터트리기 : 미션 수행 후 풍선을 터트리며 스트레스를 해소하고 환경도 생각해요. 2. 버려진 양말목, 천연수세미, 바다유리 마그넷 만들기 중 원하는 프로그램을 골라서 참여하는 원데이 클래스. 간단한 체험으로 멋진 작품을 완성하는 쉬고, 만들고, 힐링하는 시간!! 스탬프 획득 미션은 1번이나 2번 둘중 하나만 활동해도 획득 가능"
  },
  {
    "name": "레드타이",
    "location": "2-3",
    "description": "인생을 건 베팅, 레드타이 경제 카지노!",
    "detail": "당첨 확률 60%의 누구나 구매할 수 있는 복권! 무승부로 하지 않을래...? 1등과 2등을 예측하는 경마! 릴스에서 보던 바로 그 인간 룰렛! 위의 세 가지 활동을 즐기기만 해도 스탬프 쾅쾅! 바로 보상 싹 받아주고! 도파민 콸콸콸~!"
  },
  {
    "name": "바이오홀릭",
    "location": "생물실",
    "description": "생명과학의 원리를 실험과 게임으로 재밌게 느낄 수 있는 바이오홀릭!",
    "detail": "실험내용 발표: 동아리에서 진행한 세포 추출 실험의 내용, 결과물 발표 / 다윈의 YACHU 다이스: 주사위를 굴려 제시된 염기서열 조합을 맞춰 이기는 게임 / 혈액형실험:채혈기로 혈액을 채혈한 후 혈액형을 판정하는 실험 / 심박수맞추기: 호흡을 통해서 제시된 심박수를 맞추는 게임 / 경마게임: 말을 움직이고, 장애물에서 생명과학 퀴즈를 풀어 먼저 도달하면 이기는 게임 / 에바가리온연합 에코, 가피, 바이오홀릭의 각 도장을 모두 받은 학생은 선착순으로 특별 상품을 제공."
  },
  {
    "name": "방송부",
    "location": "2-6",
    "description": "2025 최고의 사진관",
    "detail": "평소에 쉽게접하지 못했던 퍼스널컬러 체험으로 자신에게 어울리는 옷이나 착장을 알아볼수 있습니다. 타투스티커를 붙여 본인의 세심한 디테일을 추가하고 친구들과 사진을 찍기만 하면 스템프를 드립니다. 사진을 인쇄하여 친구들과의 추억또한 남길수 있습니다."
  },
  {
    "name": "생각의판",
    "location": "1-1",
    "description": "동아리 내 구비된 보드게임 및 자체 제작 보드게임 체험",
    "detail": "동아리내에서 제작한 국어 주제의 보드게임과, 과학 주제의 보드게임, 그리고 루미큐브, 할리갈리, 부루마블, 라비린스 등 그 외에 매우 다양한 보드게임을 원하는대로 체험해볼수 있습니다! 보드게임을 한번만 체험해도 스탬프를 쉽게 받아갈수 있으니 많은 방문 바랍니다!"
  },
  {
    "name": "아이러닝",
    "location": "컴퓨터실",
    "description": "파이썬, 유니티 기반 게임 및 반도체 공정 체험 활동",
    "detail": "★ 4차 산업 혁명 시대의 주도자가 되고 싶은 사람들은 오라!! ★ 파이썬과 유니티 프로그램을 이용하여 직접 프로그래밍한 게임을 체험할 수 있도록 제작하고 체험자 중 고득점자에게 상품을 제공한다. 불이 켜지는 LED를 맞춰 점점 늘어나는 상품을 얻을 수 있다. 열을 전기로 전환하는 열전 반도체 소자인 펠티어 소자를 활용한 간이 선풍기에 직접 열을 가해 전류가 만들어지는 체험을 한다. 반도체 8대 공정을 간이로 체험해 봄으로써 반도체가 생산되는 과정을 알게 된다."
  },
  {
    "name": "아크매틱",
    "location": "2-9",
    "description": "기계-건축 관문을 넘어서 보상을 획득하는 공학 챌린지",
    "detail": "뒷문으로 들어오면 바로 기계 건축을 테마로 한 관문들이 이어진다. 퀴즈를 풀어 아크머니를 획득해 첫번째 관문을 통과하고 길목엔 아크매틱의 작품들을 감상할 수 있다. 코너를 돌면 사회자와 젠가 컵쌓기 대결을 펼쳐 아크머니를 획득해 관문을 통과하고 마지막으로 미니카를 제작하여 아크머니를 획득하여 관문을 통과하고 이때까지 관문을 통과하며 받은 아크머니를 통해 상품대에서 간식을 교환하면 된다. 포스터를 획득하는 방법은 3가지 게임에서 모두 아크머니를 지급 받았을 때 포스터를 확인 할 수 있다."
  },
  {
    "name": "에코",
    "location": "화학실",
    "description": "범인은 바로 너! 화학으로 밝히는 범죄 현장 분석",
    "detail": "화학실에서 벌어진 살인 사건! 범인은 바로 평택고 선생님 중 한 명?! 시계반응을 이용한 수사 퍼즐부터, 실제 범죄 현장에서 사용하는 루미놀 반응, 지문 검출 실험까지! 다양한 화학 반응을 직접 체험하며 사건 현장에 숨겨진 단서를 찾아 진실을 밝혀보세요. 조금씩 드러나는 범인의 정체… 마지막에는 스탬프와 더불어 산염기 밸런스 게임으로 얻은 pH 값에 따라 특별 보상도 받을 수 있습니다. 에코·바이오홀릭·가피 과학 동아리의 모든 체험을 완료하면? 완주자에게만 주어지는 스페셜 굿즈까지 놓치지 마세요!"
  },
  {
    "name": "여가활용부",
    "location": "통합지원실",
    "description": "좋은 글귀를 손글씨로 써서 전시",
    "detail": "좋은 글귀를 손글씨로 써서 통합지원반 앞 복도에 전시할 예정입니다."
  },
  {
    "name": "역사랑",
    "location": "1-6",
    "description": "역사 방탈출: 사도세자가 되어 뒤주를 탈출하세요.",
    "detail": "사도세자가 뒤주에 갇혀 죽은 사건을 배경으로한 역사 방탈출게임입니다. 사도세자는 뒤주에 갇힌지 8일만에 사망하였는데요. 과연 당신은 사도세자가 되어 제한시간내 구석기 시대부터 오늘날 대한민국까지의 역사를 담은 문제를 풀고 뒤주에서 탈출함으로써 역사를 바꿀수 있을까요? ※주의※ 4인1팀으로 구성, 최단기간내 탈출팀에게 특별한 상품부여 (성공/실패 팀도 상품 지급은 함). 방탈출에 참여하여 완주 후 해태와 기념사진 찍으면 스탬프 지급 *게임의 재미와 공정성을 위해 다른사람들에게 스포하지 마세요*"
  },
  {
    "name": "정치언론부",
    "location": "1-2",
    "description": "학생 주도형 게임장 테마 음료 카페 아스트라(Astra)",
    "detail": "아스트라(Astra)는 동아리 이데아에서 운영하는 학생 주도형 카드 전략 게임 공간이자, 다양한 테마 체험과 음료 바 컨셉이 결합된 이상적인 즐거움의 공간입니다. 입장 시 시사 퀴즈에 참여해 게임 칩을 획득하고, 다트, 사격, 타이머 맞추기 등 미니게임으로 추가 보상을 얻을 수 있습니다. 이후 친구나 진행요원과 카드 전략 게임에서 승리하여 게임 칩을 획득하고 음료를 받아갈 수 있습니다. 전략과 판단, 지성와 상식을 모두 경험할 수 있는 공간입니다. (위 3가지 테마 모두 이용 시 스탬프 제공)"
  },
  {
    "name": "축구부",
    "location": "1-5,운동장",
    "description": "킹오브 풋(연승으로 왕좌를 차지하라! 개인 참가 풋살 배틀)",
    "detail": "(1) 경기 방식 -1대1 개인전 -경기시간: 1분~1분 30초 러닝타임 -경기장(운동장): 미니 풋살 코트(10m × 15m 수준) -골대: 소형 골대(약 1~1.2m 폭) -승리자만 코트에 남고, 도전자가 줄에서 바로 입장 -연속 승리(연승)가 곧 점수 - 2~3시간 동안 누적 연승 1위~3위를 선정"
  },
  {
    "name": "화생방",
    "location": "1-7",
    "description": "화생방 퀴즈, 미니게임 / 화학 실험 체험",
    "detail": "화학과 생명과학을 주제로 한 퀴즈를 맞출 시 스탬프 획득 가능! 화생방 미니게임을 통과해도 스탬프 획득 가능! 스탬프 획득 후에 화학 실험 체험 부스에서 친환경 물병 오호 물주머니 만들기 체험과 무지개 물탑 만들기 체험까지 즐길수 있다!"
  }
];

function ClubActivities() {
  const [expandedIndex, setExpandedIndex] = useState(null);
  const location = useLocation();
  const refs = useRef([]);

  useEffect(() => {
    if (location.state && location.state.targetClubName) {
      const targetName = location.state.targetClubName;
      const index = activities.findIndex(a => a.name === targetName);

      if (index !== -1) {
        setExpandedIndex(index);
        // 약간의 지연 후 스크롤 (렌더링 후)
        setTimeout(() => {
          if (refs.current[index]) {
            refs.current[index].scrollIntoView({ behavior: 'smooth', block: 'center' });
          }
        }, 100);
      }
    }
  }, [location.state]);

  const toggleActivity = (index) => {
    if (expandedIndex === index) {
      setExpandedIndex(null);
    } else {
      setExpandedIndex(index);
    }
  };

  return (
    <div className="activities-container">
      <div className="activities-header">
        <h2>동아리별 활동 내용</h2>
        <p>원하는 동아리를 클릭하면 상세 내용을 볼 수 있습니다.</p>
      </div>
      <div className="activities-list">
        {activities.map((activity, index) => (
          <div
            key={index}
            ref={el => refs.current[index] = el}
            className={`activity-card ${expandedIndex === index ? 'expanded' : ''}`}
            onClick={() => toggleActivity(index)}
          >
            <div className="activity-header-row">
              <div className="activity-name">
                {activity.name} <span className="activity-location">({activity.location})</span>
              </div>
              <div className="toggle-icon">{expandedIndex === index ? '▲' : '▼'}</div>
            </div>
            <div className="activity-description">{activity.description}</div>
            {expandedIndex === index && (
              <div className="activity-detail">
                <hr className="detail-divider" />
                {activity.detail}
              </div>
            )}
          </div>
        ))}
      </div>
    </div>
  );
}

export default ClubActivities;